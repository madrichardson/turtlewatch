---
title: "Data Dashboard"
format: html
toc: false
page-layout: full
anchor-sections: false
---

::: {.dashboard-card}
### El Ni√±o Conditions

**Status:** <span id="elnino-status">Loading...</span>  
**Synopsis:** <span id="elnino-synopsis">Loading...</span>  
**Advisory Date:** <span id="elnino-date">Loading...</span>  

<small>[Data source: NOAA CPC ENSO Advisory](https://www.cpc.ncep.noaa.gov/products/analysis_monitoring/enso_advisory/ensodisc.shtml)</small>
:::

::: {.dashboard-card}
### Marine Heatwave Conditions

**Status:** <span id="heatwave-status">Loading...</span>  
**Forecast Date:** <span id="heatwave-date">Loading...</span>  
**Period:** <span id="heatwave-period">Loading...</span>  

<small>[Data source: NOAA PSL Marine Heatwave Portal](https://psl.noaa.gov/marine-heatwaves/)</small>
:::

::: {.dashboard-card}
### TOTAL Bycatch Avoidance Indicator

**Latest Index Value:** <span id="indicator-value">Loading...</span>  
**Alert Status:** <span id="indicator-alert">Loading...</span>  
**Forecast Date:** <span id="indicator-date">Loading...</span>  

![](data/images/indicator_2024.png){#indicator-plot fig-align="center"}
:::

::: {.dashboard-card}
### Monthly Sea Surface Maps (Last 6 Months)

**Sea Surface Temperature (SST):**  
<img id="sst-map" alt="Latest SST Map" style="max-width: 100%;"/>

**Sea Surface Temperature Anomaly:**  
<img id="anom-map" alt="Latest Anomaly Map" style="max-width: 100%;"/>

<small>Maps show monthly mean SST and anomalies off Southern California. Loggerhead Conservation Area shown in black outline.</small>
:::


<script>
document.addEventListener("DOMContentLoaded", async function() {
  // === Load ENSO advisory ===
  try {
    const ensoResp = await fetch("data/json/elnino_last.json");
    const ensoData = await ensoResp.json();
    document.getElementById("elnino-status").textContent = ensoData.status;
    document.getElementById("elnino-synopsis").textContent = ensoData.synopsis;
    document.getElementById("elnino-date").textContent = ensoData.date_print;
  } catch (err) {
    console.error("Error loading ENSO JSON:", err);
  }

  // === Load Heatwave info ===
  try {
    const hwResp = await fetch("data/json/heatwave.json");
    const hwData = await hwResp.json();
    document.getElementById("heatwave-status").textContent = hwData.heat_status;
    document.getElementById("heatwave-date").textContent = hwData.heat_date;
    document.getElementById("heatwave-period").textContent = hwData.heat_period;
  } catch (err) {
    console.error("Error loading heatwave JSON:", err);
  }

  // === Load TOTAL indicator (latest index + alert) ===
  try {
    const twResp = await fetch("data/json/web_data.json");
    const twData = await twResp.json();
    document.getElementById("indicator-alert").textContent = twData.alert;
    document.getElementById("indicator-date").textContent = twData.fc_date;
    document.getElementById("indicator-value").textContent = twData.new_index;
  } catch (err) {
    console.error("Error loading TOTAL JSON:", err);
  }

  // === Load latest SST/Anomaly maps from latest.json ===
  try {
    const mapsResp = await fetch("data/json/latest.json");
    const mapsData = await mapsResp.json();
    const latestKey = "t0"; // most recent month
    if (mapsData[latestKey]) {
      document.getElementById("sst-map").src =
        "data/images/sst_" + mapsData[latestKey].date + ".png";
      document.getElementById("anom-map").src =
        "data/images/sstAnom_" + mapsData[latestKey].date + ".png";
    }
  } catch (err) {
    console.error("Error loading maps JSON:", err);
  }
});
</script>